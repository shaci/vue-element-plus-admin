var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,l=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&i(e,t,a[t]);if(s)for(var t of s(a))o.call(a,t)&&i(e,t,a[t]);return e},r=(e,s)=>a(e,t(s));import{_ as u}from"./ContentWrap.df0d7ec7.js";import{bW as c,E as d,F as f,d as m,cd as p,ce as b,cf as v,R as g,bK as w,m as k,cg as h,aY as y,H as x,aI as I,q as O,M as _,C as j,o as C,v as z,g as T,w as L,e as N,n as D,a as E,ar as A,Y as M,P,a$ as V,c as X,b3 as Y,aP as B,$ as R,ch as $,ci as F,Z as S,cj as W,ck as G,a9 as H,aF as Z,aX as q,a0 as K,z as J,h as Q,bL as U,_ as ee,c5 as ae,G as te,cl as se,a1 as ne,a7 as oe,X as ie,cm as le,c8 as re,k as ue,x as ce,t as de}from"./index.f17de39a.js";import{m as fe}from"./typescript2.7e235180.js";import{i as me}from"./browser2.75a6ead7.js";import{u as pe}from"./index2.8ab3bd7b.js";import{d as be}from"./debounce.5ac0c047.js";import{E as ve}from"./el-button.9861d4be.js";import"./el-card.8f1c70df.js";import"./el-popper.1285574a.js";import"./index2.8bbaec30.js";import"./index2.67b87174.js";function ge(e,a,t){var s=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return c(t)&&(s="leading"in t?!!t.leading:s,n="trailing"in t?!!t.trailing:n),be(e,a,{leading:s,maxWait:a,trailing:n})}const we=d({urlList:{type:f(Array),default:()=>fe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ke=["src"];const he=ne(ee(m(r(l({},{name:"ElImageViewer"}),{props:we,emits:{close:()=>!0,switch:e=>"number"==typeof e},setup(e,{emit:a}){const t=e,s={CONTAIN:{name:"contain",icon:p(b)},ORIGINAL:{name:"original",icon:p(v)}},n=me()?"DOMMouseScroll":"mousewheel",{t:o}=pe(),i=g("image-viewer"),{nextZIndex:u}=w(),c=k(),d=k([]),f=h(),m=k(!0),ee=k(t.initialIndex),ne=y(s.CONTAIN),oe=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ie=x((()=>{const{urlList:e}=t;return e.length<=1})),le=x((()=>0===ee.value)),re=x((()=>ee.value===t.urlList.length-1)),ue=x((()=>t.urlList[ee.value])),ce=x((()=>{const{scale:e,deg:a,offsetX:t,offsetY:n,enableTransition:o}=oe.value;let i=t/e,l=n/e;switch(a%360){case 90:case-270:[i,l]=[l,-i];break;case 180:case-180:[i,l]=[-i,-l];break;case 270:case-90:[i,l]=[-l,i]}const r={transform:`scale(${e}) rotate(${a}deg) translate(${i}px, ${l}px)`,transition:o?"transform .3s":""};return ne.value.name===s.CONTAIN.name&&(r.maxWidth=r.maxHeight="100%"),r})),de=x((()=>I(t.zIndex)?t.zIndex:u()));function fe(){f.stop(),a("close")}function be(){m.value=!1}function ve(e){m.value=!1,e.target.alt=o("el.image.error")}function we(e){if(m.value||0!==e.button||!c.value)return;oe.value.enableTransition=!1;const{offsetX:a,offsetY:t}=oe.value,s=e.pageX,n=e.pageY,o=ge((e=>{oe.value=r(l({},oe.value),{offsetX:a+e.pageX-s,offsetY:t+e.pageY-n})})),i=ae(document,"mousemove",o);ae(document,"mouseup",(()=>{i()})),e.preventDefault()}function he(){oe.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ye(){if(m.value)return;const e=se(s),a=Object.values(s),t=ne.value.name,n=(a.findIndex((e=>e.name===t))+1)%e.length;ne.value=s[e[n]],he()}function xe(){if(le.value&&!t.infinite)return;const e=t.urlList.length;ee.value=(ee.value-1+e)%e}function Ie(){if(re.value&&!t.infinite)return;const e=t.urlList.length;ee.value=(ee.value+1)%e}function Oe(e,a={}){if(m.value)return;const{zoomRate:t,rotateDeg:s,enableTransition:n}=l({zoomRate:1.4,rotateDeg:90,enableTransition:!0},a);switch(e){case"zoomOut":oe.value.scale>.2&&(oe.value.scale=Number.parseFloat((oe.value.scale/t).toFixed(3)));break;case"zoomIn":oe.value.scale<7&&(oe.value.scale=Number.parseFloat((oe.value.scale*t).toFixed(3)));break;case"clockwise":oe.value.deg+=s;break;case"anticlockwise":oe.value.deg-=s}oe.value.enableTransition=n}return O(ue,(()=>{_((()=>{const e=d.value[0];(null==e?void 0:e.complete)||(m.value=!0)}))})),O(ee,(e=>{he(),a("switch",e)})),j((()=>{var e,a;!function(){const e=ge((e=>{switch(e.code){case te.esc:t.closeOnPressEscape&&fe();break;case te.space:ye();break;case te.left:xe();break;case te.up:Oe("zoomIn");break;case te.right:Ie();break;case te.down:Oe("zoomOut")}})),a=ge((e=>{Oe((e.wheelDelta?e.wheelDelta:-e.detail)>0?"zoomIn":"zoomOut",{zoomRate:1.2,enableTransition:!1})}));f.run((()=>{ae(document,"keydown",e),ae(document,n,a)}))}(),null==(a=null==(e=c.value)?void 0:e.focus)||a.call(e)})),(e,a)=>(C(),z(U,{to:"body",disabled:!e.teleported},[T(Q,{name:"viewer-fade",appear:""},{default:L((()=>[N("div",{ref_key:"wrapper",ref:c,tabindex:-1,class:D(E(i).e("wrapper")),style:K({zIndex:E(de)})},[N("div",{class:D(E(i).e("mask")),onClick:a[0]||(a[0]=A((a=>e.hideOnClickModal&&fe()),["self"]))},null,2),M(" CLOSE "),N("span",{class:D([E(i).e("btn"),E(i).e("close")]),onClick:fe},[T(E(P),null,{default:L((()=>[T(E(V))])),_:1})],2),M(" ARROW "),E(ie)?M("v-if",!0):(C(),X(R,{key:0},[N("span",{class:D([E(i).e("btn"),E(i).e("prev"),E(i).is("disabled",!e.infinite&&E(le))]),onClick:xe},[T(E(P),null,{default:L((()=>[T(E(Y))])),_:1})],2),N("span",{class:D([E(i).e("btn"),E(i).e("next"),E(i).is("disabled",!e.infinite&&E(re))]),onClick:Ie},[T(E(P),null,{default:L((()=>[T(E(B))])),_:1})],2)],64)),M(" ACTIONS "),N("div",{class:D([E(i).e("btn"),E(i).e("actions")])},[N("div",{class:D(E(i).e("actions__inner"))},[T(E(P),{onClick:a[1]||(a[1]=e=>Oe("zoomOut"))},{default:L((()=>[T(E($))])),_:1}),T(E(P),{onClick:a[2]||(a[2]=e=>Oe("zoomIn"))},{default:L((()=>[T(E(F))])),_:1}),N("i",{class:D(E(i).e("actions__divider"))},null,2),T(E(P),{onClick:ye},{default:L((()=>[(C(),z(S(E(ne).icon)))])),_:1}),N("i",{class:D(E(i).e("actions__divider"))},null,2),T(E(P),{onClick:a[3]||(a[3]=e=>Oe("anticlockwise"))},{default:L((()=>[T(E(W))])),_:1}),T(E(P),{onClick:a[4]||(a[4]=e=>Oe("clockwise"))},{default:L((()=>[T(E(G))])),_:1})],2)],2),M(" CANVAS "),N("div",{class:D(E(i).e("canvas"))},[(C(!0),X(R,null,H(e.urlList,((e,a)=>Z((C(),X("img",{ref_for:!0,ref:e=>d.value[a]=e,key:e,src:e,style:K(E(ce)),class:D(E(i).e("img")),onLoad:be,onError:ve,onMousedown:we},null,46,ke)),[[q,a===ee.value]]))),128))],2),J(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}})),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]));const ye=m({__name:"ImageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:oe.number.def(200),initialIndex:oe.number.def(0),infinite:oe.bool.def(!0),hideOnClickModal:oe.bool.def(!1),appendToBody:oe.bool.def(!1),show:oe.bool.def(!1)},setup(e){const a=e,t=x((()=>{const e=l({},a);return delete e.show,e})),s=k(a.show),n=()=>{s.value=!1};return(e,a)=>s.value?(C(),z(E(he),ie({key:0},E(t),{onClose:n}),null,16)):M("",!0)}});let xe=null;const Ie=m({__name:"ImageViewer",setup(e){const{t:a}=ue(),t=()=>{!function(e){if(!le)return;const{urlList:a,initialIndex:t=0,infinite:s=!0,hideOnClickModal:n=!1,appendToBody:o=!1,zIndex:i=2e3,show:l=!0}=e,r={},u=document.createElement("div");r.urlList=a,r.initialIndex=t,r.infinite=s,r.hideOnClickModal=n,r.appendToBody=o,r.zIndex=i,r.show=l,document.body.appendChild(u),xe=T(ye,r),re(xe,u)}({urlList:["https://img1.baidu.com/it/u=657828739,1486746195&fm=26&fmt=auto&gp=0.jpg","https://img0.baidu.com/it/u=3114228356,677481409&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=508846955,3814747122&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=3536647690,3616605490&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=4087287201,1148061266&fm=26&fmt=auto&gp=0.jpg","https://img2.baidu.com/it/u=3429163260,2974496379&fm=26&fmt=auto&gp=0.jpg"]})};return(e,s)=>(C(),z(E(u),{title:E(a)("imageViewerDemo.imageViewer"),message:E(a)("imageViewerDemo.imageViewerDes")},{default:L((()=>[T(E(ve),{type:"primary",onClick:t},{default:L((()=>[ce(de(E(a)("imageViewerDemo.open")),1)])),_:1})])),_:1},8,["title","message"]))}});export{Ie as default};
